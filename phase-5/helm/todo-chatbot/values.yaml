# ==============================================
# Todo AI Chatbot - Helm Values
# Phase 5: Advanced Cloud Deployment with Dapr
# ==============================================

# ---------------------------------------------
# Dapr Configuration
# ---------------------------------------------
dapr:
  enabled: true
  backend:
    appId: "todo-backend"
    appPort: "8000"
    httpPort: "3500"
    logLevel: "info"

# ---------------------------------------------
# Frontend Configuration
# ---------------------------------------------
frontend:
  replicaCount: 1

  image:
    repository: todo-frontend
    tag: local
    pullPolicy: Never

  service:
    type: NodePort
    port: 3000
    targetPort: 3000
    nodePort: 30080

  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits:
      cpu: 500m
      memory: 512Mi

  healthCheck:
    enabled: true
    type: tcp
    port: 3000
    initialDelaySeconds: 10
    periodSeconds: 10

  env:
    - name: NODE_ENV
      value: production

# ---------------------------------------------
# Backend Configuration
# ---------------------------------------------
backend:
  replicaCount: 1

  image:
    repository: todo-backend
    tag: local
    pullPolicy: Never

  service:
    type: ClusterIP
    port: 8000
    targetPort: 8000

  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits:
      cpu: 500m
      memory: 512Mi

  healthCheck:
    enabled: true
    type: http
    path: /health
    port: 8000
    initialDelaySeconds: 15
    periodSeconds: 10

  env:
    - name: PYTHONUNBUFFERED
      value: "1"
    - name: DAPR_HTTP_PORT
      value: "3500"
    - name: KAFKA_PUBSUB_NAME
      value: "kafka-pubsub"
    - name: STATE_STORE_NAME
      value: "statestore"
    - name: LOG_LEVEL
      value: "INFO"

# ---------------------------------------------
# PostgreSQL Configuration (local only)
# ---------------------------------------------
postgresql:
  enabled: true
  image:
    repository: postgres
    tag: "16-alpine"
  database: "todo_db"
  username: "todo_user"
  storage: "1Gi"
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits:
      cpu: 500m
      memory: 512Mi

# ---------------------------------------------
# Kafka (Redpanda) Configuration
# ---------------------------------------------
kafka:
  enabled: true
  image:
    repository: redpandadata/redpanda
    tag: latest
  resources:
    requests:
      cpu: 200m
      memory: 256Mi
    limits:
      cpu: 1000m
      memory: 1Gi

# ---------------------------------------------
# Secrets Configuration
# ---------------------------------------------
secrets:
  create: true
  name: todo-secrets
  databaseUrl: ""
  openaiApiKey: ""
  betterAuthSecret: ""
  postgresPassword: "todo_pass"

# ---------------------------------------------
# ConfigMap Configuration
# ---------------------------------------------
config:
  create: true
  name: todo-config
  frontendUrl: "http://localhost:30080"
  backendUrl: "http://todo-backend:8000"
  apiUrl: "http://todo-backend:8000"

# ---------------------------------------------
# Common Labels
# ---------------------------------------------
commonLabels:
  app.kubernetes.io/name: todo-chatbot
  app.kubernetes.io/instance: todo-chatbot
  app.kubernetes.io/version: "2.0.0"
  app.kubernetes.io/managed-by: Helm

# ---------------------------------------------
# Pod Security Context
# ---------------------------------------------
podSecurityContext:
  runAsNonRoot: true
  runAsUser: 1000

# ---------------------------------------------
# Node Selection (empty for local dev)
# ---------------------------------------------
affinity: {}
tolerations: []
nodeSelector: {}
